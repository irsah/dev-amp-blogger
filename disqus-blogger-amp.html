<div id="comments"></div>

<script>
/*
# Title		:	Disqus Comments on Blogger AMP HTML Template
# Ver		:	0.9.0
# Date		:	Jan 2017
# Demo		:	https://blog-amp.blogspot.com
# Author	:	irsah.com
#
# Usages for Disqus:
#
<amp-iframe 
	expr:src='&quot;{{PATH-TO-FILE}}?ampactions={{actions}}shortname={{DISQUS_SHORTNAME}}&amp;pagetype=item&amp;canonicalurl=&quot; + data:blog.canonicalUrl + &quot;&amp;url=&quot; + data:blog.url + &quot;&amp;homepageurl=&quot; + data:blog.homepageUrl + &quot;&amp;canonicalhomepageurl=&quot; + data:blog.canonicalHomepageUrl' 
	frameborder='0' 
	height='400' 
	layout='responsive' 
	resizable='resizable' 
	sandbox='allow-forms allow-scripts allow-same-origin allow-modals allow-popups' 
	width='600'>
</amp-iframe>
#
# Instructions:
# Copy paste <amp-iframe/> markup above & place anywhere at Blogger HTML within <body>...</body tag.
# Replace {{PATH-TO-FILE}} to this file hosted on an HTTPS enabled host.
# Replace {{DISQUS_SHORTNAME}} with your Disqus shortname created at your dashboard.
# Replace {{ pagetype }} with value " index " (without quotes) to load disqus index.js.
#
# Usages for external images:
<amp-iframe 
	src='{{PATH-TO-FILE}}?ampactions=image&imgsrc={{IMAGE_SRC}}&amp;imgwitdh={{IMAGE_WIDTH}}&amp;imgheight={{IMAGE_HEIGHT}}&amp;imgalt={{IMAGE_ALT}}&amp;imglink={{IMAGE_LINK}}&amp;imgtarget={{IMAGE_TARGET}}' 
	frameborder='0' 
	height='400' 
	layout='responsive' 
	resizable='resizable' 
	sandbox='allow-forms allow-scripts allow-same-origin allow-modals allow-popups' 
	width='600'>
</amp-iframe>
#
# Instructions:
# Copy paste <amp-iframe/> markup above & place anywhere at Blogger HTML within <body>...</body tag.
# Query ampactions=image required.
# Replace {{PATH-TO-FILE}} to this file hosted on an HTTPS enabled host.
# Replace {{IMAGE_SRC}} with the external image src urls. HTTPS checks. If none provided returns false.
# Replace {{IMAGE_WIDTH}} with the image width (default: width='')
# Replace {{IMAGE_HEIGHT}} with the image height (default: height='')
# Replace {{IMAGE_ALT}} with an image alt (default: alt='')
# Replace {{IMAGE_LINK}} with the image link URL. If none provided displays image w/o link.
# Replace {{IMAGE_TARGET}} with the image link target (default: target='_blank')
#
*/
  var d = document;
  var w = window;

  w.addEventListener('message', receiveMessage, false);
  
  function receiveMessage( event ) {
	  
    if ( event.data ) {
      var msg;
      try {
        msg = JSON.parse( event.data );
      } catch (err) {}
      if (!msg) return false;
      if ( msg.name === 'resize' ) {
        w.parent.postMessage({
          sentinel: 'amp',
          type: 'embed-size',
          height: msg.data.height
        }, '*');
      };
    };    
  };

  function getQueryValue( vars ) {
    var query = w.location.search.substring(1);
    var variable = query.split('&');
    for (var i = 0; i < variable.length; i++) {
      var values = variable[i].split('=');
      if ( values[0] === vars ) {
        return values[1];
      };
    };
    return (false);
  };
  
  /* loads Disqus js */
  var pagetype = getQueryValue('pagetype');
  if ( pagetype === false ) pagetype = 'item';
  var disqus_shortname = getQueryValue('shortname');
  var disqus_blogger_current_url = getQueryValue('canonicalurl');

  if ( !disqus_blogger_current_url.length ) {
    disqus_blogger_current_url = getQueryValue('url');
  };

  var disqus_blogger_homepage_url = getQueryValue('homepageurl');
  var disqus_blogger_canonical_homepage_url = getQueryValue('canonicalhomepageurl');
	
  function loadDisqus(){ 
	
	  if( pagetype === "item"){
		  
		  (function() {
		    var js = d.createElement('script');
		    js.type = 'text/javascript';
		    js.async = true;
		    js.src = '//'+disqus_shortname+'.disqus.com/blogger_item.js';
		    (d.getElementsByTagName('head')[0] || d.getElementsByTagName('body')[0]).appendChild( js );
		  })();
		  
		} else {
		
		  (function() {
		    var js = d.createElement('script');
		    js.type = 'text/javascript';
		    js.async = true;
		    js.src = '//'+disqus_shortname+'.disqus.com/blogger_index.js';
		    (d.getElementsByTagName('head')[0] || d.getElementsByTagName('body')[0]).appendChild( js );
		  })();
		  
	  };
	};
	
	/* loads images into amp-iframes from external HTTPS resources */
	
	function loadImage(){
		
		d.getElementById('discus_thread').parentNode().removeChild( d.getElementById('discus_thread') );
		
		var image,
				imgsrc 		= getQueryValue( 'imgsrc' ),
				imglink		= getQueryValue( 'imglink' );
				
		if ( imgsrc !== false	|| imgsrc.indexOf('https:') !== -1 ){
			
			var img 		= d.createElement('img');
			img.src 		= imgsrc;
			img.setAttribute( "width", getQueryValue( 'imgwidth' ) === false ? '' : getQueryValue( 'imgwidth' ) );
			img.setAttribute( "height", getQueryValue( 'imgheight' ) === false ? '' : getQueryValue( 'imgheight' ) );
			img.setAttribute( "alt", getQueryValue( 'imgalt' ) === false ? '' : getQueryValue( 'imgalt' ) );	
			image = img;
			
			if ( imglink !== false ){
				var a 		= d.createElement('a');
				a.href  	= imglink.indexOf('http:') !== -1 ? imglink.replace('http:','https:') : imglink;	
				a.setAttribute("target", getQueryValue( 'imgtarget' ) === false ? '_blank' : getQueryValue( 'imgtarget' ) );	
				image 		= a.appendChild( img )	
			};
			
			(d.getElementsByTagName('head')[0] || d.getElementsByTagName('body')[0]).appendChild( image );

		} else {		
			
			return (false);
			
		};
	}; 
	
	var actions = getQueryValue( 'ampactions' );
	
	switch ( actions ){
		case 'disqus' : loadDisqus(); break;
		case 'image' : loadImage();  break;
		default: 
			var div = d.createElement('div');
			div.innerHTML = 'Error(s) in plugin query values!';
			(d.getElementsByTagName('head')[0] || d.getElementsByTagName('body')[0]).appendChild( div );		
	};
  
</script>

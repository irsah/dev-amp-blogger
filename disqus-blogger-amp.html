<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8>
<style>
html, body {
	-webkit-font-smoothing: antialiased;
	-webkit-text-size-adjust: 100%;
	font-size : 100%;
	font-weight : 400;
	height : 100%;
	line-height: 1.428;
	font-family : sans-serif, Helvetica, Arial;
	color : #333;
}
	
a , a:link { 
	color: #06c;
	text-decoration: none;
}
#feed { 
	overflow-x : hidden;
	overflow-y : auto;
	height: 600px;
}
	
#feed , .entryWrapper { 
	display: block 
}
	
.entryWrapper { 
	overflow : hidden; 
	padding-top : 15px; 
	padding-bottom: 15px; 
	border-bottom: 1px solid #ddd; 
}
.entryImage { 
	display : inline-block; 
	float : left; 
	margin-right : 15px; 
	width: 33%; 
}
	
.entryImage img { 
	display : block; 
	max-width : 100%; 
	height : auto; 
}
.entryText {
	display : table-cell;
}

h4 {
	font-weight: 500;
	margin : 0;
	padding : 0;
}
	
.entryDate {
	font-size : 80%;
	display : block;
	margin : 15px 0;
	opacity : .87;
}

.entryContent {
	font-size: 85%;
	opacity : .87;
}
</style>    

</head>
<body>

<div id="feed"></div>
<div id="comments"></div>
	
<script>
/*
# Title		:	Disqus Comments on Blogger AMP HTML Template
# Ver		:	0.9.0
# Date		:	Jan 2017
# Demo		:	https://blogr-amp.blogspot.com
# Author	:	irsah.com
#
# Usages for Disqus:
#
<amp-iframe 
	expr:src='&quot;{{PATH-TO-FILE}}?ampactions=disqus&amp;shortname={{DISQUS_SHORTNAME}}&amp;pagetype={{PAGE_TYPE}}&amp;fontfamily={{FONT_FAMILY}}&amp;fontlinkcolor={{LINK_COLOR}}&amp;canonicalurl=&quot; + data:blog.canonicalUrl + &quot;&amp;url=&quot; + data:blog.url + &quot;&amp;homepageurl=&quot; + data:blog.homepageUrl + &quot;&amp;canonicalhomepageurl=&quot; + data:blog.canonicalHomepageUrl' 
	frameborder='0' 
	height='400' 
	layout='responsive' 
	resizable='resizable' 
	sandbox='allow-forms allow-scripts allow-same-origin allow-modals allow-popups' 
	width='600'>
</amp-iframe>
#
# Instructions:
# Copy paste <amp-iframe/> markup above & place anywhere at Blogger HTML within <body>...</body> tag.
# [*] Replace {{PATH-TO-FILE}} to this file hosted on an HTTPS enabled host.
# [*] Replace {{DISQUS_SHORTNAME}} with Disqus shortname created/attached to blog.
# Replace {{ PAGETYPE }} with value " index " or " item " (without quotes). (default: item)
# Replace {{FONT_FAMILY}} with CSS font family. (default: sans-serif)
# Replace {{LINK_COLOR}} with HEX color code. (default: 000000)
#
# [*] required values
#
*/

var doc = document;
var win = window;

win.addEventListener('message', receiveMessage, false);
  
function receiveMessage( event ) {
	if ( event.data ) {
		var msg;
		try {
			msg = JSON.parse( event.data );
		} catch (err) {};
		if (!msg) return false;
		if ( msg.name === 'resize' ) {
			win.parent.postMessage({
				sentinel: 'amp',
				type: 'embed-size',
				height: msg.data.height
			}, '*');
		};
	};    
};

var $GET = function() {
	var s = window.location.search.substr(1),
	p = s.split(/\&/), l = p.length, kv, r = {};
	if (l === 0) { return (false); }
	while (l--) {
		kv = p[l].split(/\=/);
		r[kv[0]] = decodeURIComponent( kv[1] || '' ) || true ;
	};
	return r;
}();
	
function getQueryValue( vars ) {
	var query = win.location.search.substring(1);
	var variable = query.split('&');
	for (var i = 0; i < variable.length; i++) {
		var values = variable[i].split('=');
		if ( values[0] === vars ) {
			return decodeURIComponent( values[1].replace(/\+/g, " ") );
	    	};
	};
	return (false);
};
  
function loadMessage(){
	var H3 = doc.createElement('h3');
	H3.innerHTML = 'No contents available.'
	doc.getElementsByTagName('body')[0].appendChild( H3 )
};

function loadJs( scripts, index, loaded ) {
	if ( scripts[index] ) {
		var files = doc.createElement('script');
		files.type = 'text/javascript';
		files.src = scripts[index];
		files.onload = function(){
			index = index + 1;
			loadJs( scripts, index, loaded )
		};
		doc.getElementsByTagName("head")[0].appendChild( files )
	 } else {
		loaded();
	 };
};
var pagetype;	
if ( $GET.pagetype === false ) pagetype = 'item';
var disqus_shortname = $GET.shortname;
var disqus_blogger_current_url = $GET.canonicalurl;
if ( !disqus_blogger_current_url.length ) {
  disqus_blogger_current_url = $GET.url;
};
var disqus_blogger_homepage_url = $GET.homepageurl;
var disqus_blogger_canonical_homepage_url = $GET.canonicalhomepageurl;	
	
/* loads Disqus js */
function loadDisqus(){ 
	doc.getElementById('feed').parentNode.removeChild( doc.getElementById('feed') );
	var fontfamily = $GET.fontfamily === false ? 'sans-serif': $GET.fontfamily;
	var fontlinkcolor = $GET.fontlinkcolor === false ? '000000' : $GET.fontlinkcolor ;
	var disquscss = '#disqus_thread { font-family:' + fontfamily + '} a { color: #' + fontlinkcolor + '}';
	var head = doc.getElementsByTagName('head')[0];
	var tag = doc.createElement('style');
	tag.type = 'text/css';
	if ( tag.styleSheet ){
  		tag.styleSheet.cssText = disquscss;
	} else {
  		tag.appendChild( doc.createTextNode( disquscss ) );
	};
	head.appendChild( tag );

	if( pagetype === "item"){
		var js = doc.createElement('script');
		js.type = 'text/javascript';
		js.async = true;
		js.src = '//' + disqus_shortname + '.disqus.com/blogger_item.js';
		doc.getElementsByTagName('head')[0].appendChild( js );
	};
};
	
function loadFeed(){

	var feed = $GET('canonicalhomepageurl') +'feeds/posts/default?alt=rss';
	var feed_ssl = $GET.feedssl === false ? true : false;
	var feed_limit = $GET.feedlimit === false ? 5 : parseFloat( $GET.feedlimit  );
	var feed_tags = $GET.feedtags === false ? false : true;
	var feed_date = $GET.feeddate === false ? true : false;
	var feed_date_format = $GET.feeddateformat === false ? 'spellmonth' : $GET.feeddateformat;
	var feed_title = $GET.feedtitletag === false ? 'h4' : $GET.feedtitletag;
	var feed_content = $GET.feedcontent === false ? true : false;
	var feed_image = $GET.feedimage === false ? true : false;
	var feed_snippet = $GET.feedsnippet === false ? true : false;
	var feed_snippet_limit = $GET.feedsnippetlimit === false ? 160 : parseFloat( $GET.feedsnippetlimit );
	var feed_link_target = $GET.feedlinktarget === false ? '_blank' : $GET.feedlinktarget;
	var feed_height = $GET.feedcontainerheight === false ? 600 : parseFloat( $GET.feedcontainerheight );

	if( $GET.feedcss !== false ){
		var CSS = $GET.feedcss;
		var HEAD = doc.getElementsByTagName('head')[0];
		var TAG = doc.createElement('style');
		TAG.type = 'text/css';
		if ( TAG.styleSheet ){
			TAG.styleSheet.cssText = CSS;
		} else {
			TAG.appendChild( doc.createTextNode( CSS ) );
		};		
		
	};
	
	$('#feed').rssfeed( feed , {
	    ssl: feed_ssl,
	    limit: feed_limit,
	    showerror: true,
	    errormsg: '',
	    tags: feed_tags,
	    date: feed_date,
	    dateformat: feed_date_format,
	    titletag: feed_title,
	    content: feed_content,
	    image: feed_image,
	    snippet: feed_snippet,
	    snippetlimit: feed_snippet_limit,
	    linktarget: feed_link_target
	}, function () {
	    // optional callback function
	});
	
	$('#feed').height( feed_height )

};


var scripts = [];
scripts.push('https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js');
scripts.push('https://rawgit.com/bbClassic/YRSS/master/yrss.min.js');

var actions = $GET.ampactions;
	
switch ( actions ){
	case 'disqus' : loadDisqus(); break;
	case 'feed' : loadJs( scripts , 0 , function(){ loadFeed() }); break;
	default : loadMessage();
};
</script>
	
</body>
</html>
